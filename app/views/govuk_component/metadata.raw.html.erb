<%
  from ||= []
  from = Array(from)

  part_of ||= []
  part_of = Array(part_of)

  other ||= nil

  direction_class = ""
  direction_class = " direction-#{direction}" if local_assigns.include?(:direction)
%>
<div class="govuk-metadata<%= direction_class %>" data-module="toggle">
  <dl>
    <% if from.any? %>
      <dt><%= t("govuk_component.metadata.from", default: "From") %>:</dt>
      <dd><%= from.to_sentence.html_safe %></dd>
    <% end %>
    <% if part_of.any? %>
      <dt><%= t("govuk_component.metadata.part_of", default: "Part of") %>:</dt>
      <dd><%= part_of.to_sentence.html_safe %></dd>
    <% end %>
    <% if local_assigns.include?(:history) %>
      <dt><%= t("govuk_component.metadata.history", default: "History") %>:</dt>
      <dd><%= history %></dd>
    <% end %>
    <% if local_assigns.include?(:first_published) && first_published %>
      <dt><%= t("govuk_component.metadata.published", default: "Published") %>:</dt>
      <dd><%= first_published %></dd>
    <% end %>
    <% if local_assigns.include?(:last_updated) && last_updated %>
      <dt><%= t("govuk_component.metadata.last_updated", default: "Last updated") %>:</dt>
      <dd>
        <%= last_updated %><% if local_assigns.include?(:see_updates_link) %>,
          <a href="#history" data-module="track-click"
                             data-track-category="content-history"
                             data-track-action="see-all-updates-link-clicked"
                             data-track-label="history">
            <%= t("govuk_component.metadata.see_all_updates", default: "see all updates") %>
          </a>
        <% end %>
      </dd>
    <% end %>
    <% if other.present? %>
      <% other.each_with_index do |(title, definition), i| %>
        <%
          definition ||= []
          definition = Array(definition)
          list_limit = 5
          remaining = []
          if definition.length > (list_limit + 2)
            remaining = definition[list_limit..definition.length]
            definition = definition[0...list_limit]
          end
        %>
        <% if definition.any? %>
          <dt><%= title %>:</dt>
          <dd>
            <% if remaining.any? %>
              <%= definition.to_sentence(last_word_connector: ', ').html_safe %><span id="metadata-<%= i %>" class="js-hidden">, <%= remaining.to_sentence.html_safe %></span>
              <div class="toggle-wrap">
                <a href="#" data-controls="metadata-<%= i %>" data-expanded="false" data-toggled-text="- show less">+ <%= remaining.length %> more</a>
              </div>
            <% else %>
              <%= definition.to_sentence.html_safe %>
            <% end %>
          </dd>
        <% end %>
      <% end %>
    <% end %>
  </dl>
</div>
